<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Tide Chart Implementation Test</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: #1a1a1a;
            color: #f0f0f0;
            margin: 0;
            padding: 2rem;
            line-height: 1.6;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 3rem;
            padding: 1.5rem;
            background: #2a2a2a;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .test-title {
            color: #4a90e2;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .test-description {
            color: #a0a0a0;
            margin-bottom: 1.5rem;
        }
        
        .tide-chart-container {
            margin: 1rem 0;
        }
        
        .status {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .status.success {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid #2ecc71;
            color: #2ecc71;
        }
        
        .status.info {
            background: rgba(74, 144, 226, 0.2);
            border: 1px solid #4a90e2;
            color: #4a90e2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Advanced Tide Chart Implementation Test</h1>
        <p>This page tests the new 6-section tide chart implementation with various tide combinations.</p>
        
        <!-- Test Case 1: Low Tide Only -->
        <div class="test-section">
            <h2 class="test-title">Test Case 1: Low Tide Only</h2>
            <p class="test-description">Testing with ['Low'] - should highlight section 4 (LO) only</p>
            <div id="test-low" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Section 4 highlighted</div>
        </div>
        
        <!-- Test Case 2: Mid Tide Only -->
        <div class="test-section">
            <h2 class="test-title">Test Case 2: Mid Tide Only</h2>
            <p class="test-description">Testing with ['Mid'] - should highlight sections 0, 2, 3, 5 (MH, MH, ML, ML)</p>
            <div id="test-mid" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Sections 0, 2, 3, 5 highlighted</div>
        </div>
        
        <!-- Test Case 3: High Tide Only -->
        <div class="test-section">
            <h2 class="test-title">Test Case 3: High Tide Only</h2>
            <p class="test-description">Testing with ['High'] - should highlight section 1 (HI) only</p>
            <div id="test-high" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Section 1 highlighted</div>
        </div>
        
        <!-- Test Case 4: Low & Mid Tide -->
        <div class="test-section">
            <h2 class="test-title">Test Case 4: Low & Mid Tide</h2>
            <p class="test-description">Testing with ['Low', 'Mid'] - should highlight sections 3, 4, 5</p>
            <div id="test-low-mid" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Sections 3, 4, 5 highlighted</div>
        </div>
        
        <!-- Test Case 5: Low & High Tide -->
        <div class="test-section">
            <h2 class="test-title">Test Case 5: Low & High Tide</h2>
            <p class="test-description">Testing with ['Low', 'High'] - should highlight sections 1, 4</p>
            <div id="test-low-high" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Sections 1, 4 highlighted</div>
        </div>
        
        <!-- Test Case 6: Mid & High Tide -->
        <div class="test-section">
            <h2 class="test-title">Test Case 6: Mid & High Tide</h2>
            <p class="test-description">Testing with ['Mid', 'High'] - should highlight sections 0, 1, 2</p>
            <div id="test-mid-high" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: Sections 0, 1, 2 highlighted</div>
        </div>
        
        <!-- Test Case 7: All Tides -->
        <div class="test-section">
            <h2 class="test-title">Test Case 7: All Tides</h2>
            <p class="test-description">Testing with ['Low', 'Mid', 'High'] - should highlight all sections</p>
            <div id="test-all" class="tide-chart-container"></div>
            <div class="status success">✓ Expected: All sections highlighted</div>
        </div>
        
        <!-- Test Case 8: Real-time Tide -->
        <div class="test-section">
            <h2 class="test-title">Test Case 8: Real-time Tide Indicator</h2>
            <p class="test-description">Testing with real-time tide data (level: 0.3)</p>
            <div id="test-realtime" class="tide-chart-container"></div>
            <div class="status info">ℹ Real-time tide indicator should be visible at 30% position</div>
        </div>
        
        <!-- Test Case 9: Tide Notes -->
        <div class="test-section">
            <h2 class="test-title">Test Case 9: Tide Notes</h2>
            <p class="test-description">Testing with tide notes display</p>
            <div id="test-notes" class="tide-chart-container"></div>
            <div class="status info">ℹ Tide notes should be displayed below the chart</div>
        </div>
    </div>

    <!-- Include the CSS -->
    <link rel="stylesheet" href="style/surf-spot-panel-optimized.css">
    
    <script>
        // Simplified tide chart implementation for testing
        function createTideChart(bestTide, realTimeTide, tideNotes) {
            const sections = [
                { index: 0, type: 'mid-high', name: 'MH' },
                { index: 1, type: 'high', name: 'HI' },
                { index: 2, type: 'mid-high', name: 'MH' },
                { index: 3, type: 'mid-low', name: 'ML' },
                { index: 4, type: 'low', name: 'LO' },
                { index: 5, type: 'mid-low', name: 'ML' }
            ];

            // Map tide combinations to section indices
            const sectionMap = {
                'Low': [4],
                'Mid': [0, 2, 3, 5],
                'High': [1],
                'Low, Mid': [3, 4, 5],
                'Low, High': [1, 4],
                'Mid, High': [0, 1, 2],
                'Low, Mid, High': [0, 1, 2, 3, 4, 5]
            };
            
            const highlightedSections = sectionMap[bestTide.join(', ')] || [];
            
            // Generate sine wave
            const sineWavePath = generateSineWavePath();
            
            // Generate section backgrounds
            const backgroundPaths = highlightedSections.map(sectionIndex => {
                const x = sectionIndex * 40;
                return `<rect x="${x}" y="0" width="40" height="80" class="tide-chart__section-highlight" />`;
            }).join('');
            
            // Real-time indicator
            const realTimeIndicator = realTimeTide ? generateRealTimeIndicator(realTimeTide) : '';
            
            const html = `
                <div class="tide-chart-container">
                    <svg class="tide-chart__svg" viewBox="0 0 240 80">
                        <g class="tide-chart__grid">
                            ${sections.map((section, i) => `<line x1="${i * 40}" y1="0" x2="${i * 40}" y2="80" class="tide-chart__grid-line" />`).join('')}
                            <line x1="0" y1="80" x2="240" y2="80" class="tide-chart__grid-line" />
                        </g>
                        ${backgroundPaths}
                        <path d="${sineWavePath}" class="tide-chart__sine-wave" />
                        ${realTimeIndicator}
                    </svg>
                    ${tideNotes ? `<p class="panel-section__description">${tideNotes}</p>` : ''}
                </div>
            `;
            
            return html;
        }
        
        function generateSineWavePath() {
            const points = [];
            const amplitude = 30;
            const centerY = 40;
            
            for (let x = 0; x <= 240; x += 2) {
                const angle = (x / 240) * Math.PI * 2;
                const y = centerY - Math.sin(angle) * amplitude;
                points.push(`${x},${y}`);
            }
            
            return `M ${points.join(' L ')}`;
        }
        
        function generateRealTimeIndicator(realTimeTide) {
            if (!realTimeTide || realTimeTide.level === null) {
                return '';
            }
            
            const x = realTimeTide.level * 240;
            const angle = realTimeTide.level * Math.PI * 2;
            const centerY = 40;
            const amplitude = 30;
            const y = centerY - Math.sin(angle) * amplitude;
            
            return `
                <g class="tide-chart__current-tide">
                    <line x1="${x}" y1="80" x2="${x}" y2="${y}" class="tide-chart__current-tide-line" />
                    <circle cx="${x}" cy="${y}" r="4" class="tide-chart__current-tide-marker" />
                </g>
            `;
        }
        
        // Run tests
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('test-low').innerHTML = createTideChart(['Low']);
            document.getElementById('test-mid').innerHTML = createTideChart(['Mid']);
            document.getElementById('test-high').innerHTML = createTideChart(['High']);
            document.getElementById('test-low-mid').innerHTML = createTideChart(['Low', 'Mid']);
            document.getElementById('test-low-high').innerHTML = createTideChart(['Low', 'High']);
            document.getElementById('test-mid-high').innerHTML = createTideChart(['Mid', 'High']);
            document.getElementById('test-all').innerHTML = createTideChart(['Low', 'Mid', 'High']);
            document.getElementById('test-realtime').innerHTML = createTideChart(['Low', 'Mid'], { level: 0.3 });
            document.getElementById('test-notes').innerHTML = createTideChart(['Mid', 'High'], null, 'Best at Mid and High Tide');
        });
    </script>
</body>
</html>
